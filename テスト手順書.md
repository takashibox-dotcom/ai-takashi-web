# AI Takashi Web Client テスト手順書

## 📋 概要
AI Takashi Web Clientの機能テストを実施するための詳細な手順書です。

## 🚀 起動手順

### 1. APIサーバーの起動
```powershell
# PowerShellでAPIサーバーを起動
cd \\desktop-8jnpmj2\ShareExcelPython\Automate_with_Python\AI
python api_server.py
```

**確認事項:**
- `INFO: Uvicorn running on http://0.0.0.0:8000` が表示される
- `INFO: Started server process` が表示される
- エラーが発生していない

### 2. Webクライアントサーバーの起動
```powershell
# 新しいPowerShellウィンドウでWebサーバーを起動
cd \\desktop-8jnpmj2\ShareExcelPython\Automate_with_Python\AI\web-client
python serve.py
```

**確認事項:**
- `🌐 Webクライアントサーバーを起動しました`
- `📱 URL: http://localhost:3000` が表示される
- `⏹️ 終了: Ctrl+C` が表示される

### 3. ブラウザでのアクセス
- URL: `http://localhost:3000`
- ブラウザでページが正常に表示されることを確認

---

## 🧪 テスト項目

### **Phase 1: 基本動作テスト**

#### 1.1 接続状態確認
- [ ] ページ読み込み時に「サーバー接続中」と表示される
- [ ] ヘッダー右上の接続状態インジケーターが緑色
- [ ] 5秒間隔で接続チェックが実行される

#### 1.2 基本UI確認
- [ ] ヘッダーにタイトル「AI Takashi Web Client」が表示
- [ ] タブが正常に表示（チャット、キャラクター、トークン、メモリ、アカウント）
- [ ] レスポンシブデザインが正常に動作

#### 1.3 テーマ切り替え
- [ ] テーマボタン（🌙/☀️）が正常に動作
- [ ] ダークモードとライトモードの切り替え
- [ ] 設定が保持される

---

### **Phase 2: チャット機能テスト**

#### 2.1 基本チャット
- [ ] メッセージ入力フィールドが正常に動作
- [ ] 送信ボタンが正常に動作
- [ ] Enterキーでの送信
- [ ] Shift+Enterでの改行

#### 2.2 AI応答確認
- [ ] AIからの応答が正常に表示
- [ ] 応答時間が表示される
- [ ] トークン使用量が更新される

#### 2.3 画像付きチャット
- [ ] 画像選択ボタンが正常に動作
- [ ] 画像ファイルの選択
- [ ] 画像付きメッセージの送信
- [ ] 画像認識結果の確認

#### 2.4 会話履歴
- [ ] 会話履歴が正常に表示
- [ ] メッセージの日時が表示
- [ ] ユーザーとAIのメッセージが区別される

---

### **Phase 3: エクスポート機能テスト**

#### 3.1 会話履歴なしの場合
- [ ] 会話をしない状態でエクスポートボタンをクリック
- [ ] 「エクスポートする会話がありません」のメッセージが表示

#### 3.2 TXT形式エクスポート
- [ ] 数回メッセージをやり取り
- [ ] エクスポートボタンをクリック
- [ ] 形式選択で「1」を入力
- [ ] `ai_takashi_conversation.txt` ファイルがダウンロードされる
- [ ] ファイル内容にメタデータ（日時、セッションID、ユーザーID）が含まれる
- [ ] 会話内容が正しく記録されている

#### 3.3 JSON形式エクスポート
- [ ] エクスポートボタンをクリック
- [ ] 形式選択で「2」を入力
- [ ] `ai_takashi_conversation.json` ファイルがダウンロードされる
- [ ] JSON構造が正しい（metadata、messages配列）
- [ ] 各メッセージにtype、timestamp、contentが含まれる

#### 3.4 HTML形式エクスポート
- [ ] エクスポートボタンをクリック
- [ ] 形式選択で「3」を入力
- [ ] `ai_takashi_conversation.html` ファイルがダウンロードされる
- [ ] HTMLファイルがブラウザで正常に表示される
- [ ] スタイルが適用されている
- [ ] ユーザーとAIのメッセージが色分けされている

---

### **Phase 4: エラーハンドリングテスト**

#### 4.1 サーバー切断テスト
- [ ] APIサーバーを停止（Ctrl+C）
- [ ] メッセージ送信を試行
- [ ] エラーモーダルが表示される
- [ ] エラータイトル「接続エラー」が表示
- [ ] エラーメッセージ「サーバーに接続できません」が表示
- [ ] 技術的詳細セクションが表示される
- [ ] 「閉じる」ボタンが動作する

#### 4.2 リトライ機能テスト
- [ ] エラーモーダルに「再試行」ボタンが表示される（最大3回まで）
- [ ] 再試行ボタンをクリック
- [ ] 指数バックオフ（1秒、2秒、4秒）でリトライされる
- [ ] 最大試行回数に達すると再試行ボタンが非表示

#### 4.3 無効なリクエストテスト
- [ ] APIサーバーを再起動
- [ ] 無効なデータでリクエストを送信
- [ ] 適切なHTTPステータスコードに応じたエラーメッセージが表示

---

### **Phase 5: ユーザー管理テスト**

#### 5.1 ユーザー登録
- [ ] アカウントタブをクリック
- [ ] 「新規登録」をクリック
- [ ] ユーザー名、メールアドレス、パスワードを入力
- [ ] 確認パスワードを入力
- [ ] 登録ボタンをクリック
- [ ] 登録成功メッセージが表示
- [ ] ログイン画面に切り替わる

#### 5.2 ログイン
- [ ] 登録したユーザー名とパスワードでログイン
- [ ] ログイン成功メッセージが表示
- [ ] ユーザープロフィールが表示される
- [ ] キャラクター作成ボタンが有効化される

#### 5.3 プロフィール更新
- [ ] 「プロフィール編集」をクリック
- [ ] 表示名、自己紹介、アバターURLを入力
- [ ] 保存ボタンをクリック
- [ ] 更新成功メッセージが表示
- [ ] プロフィール情報が更新される

#### 5.4 パスワード変更
- [ ] 「パスワード変更」をクリック
- [ ] 現在のパスワード、新しいパスワード、確認パスワードを入力
- [ ] 変更ボタンをクリック
- [ ] 変更成功メッセージが表示

#### 5.5 ログアウト
- [ ] 「ログアウト」ボタンをクリック
- [ ] ログアウト成功メッセージが表示
- [ ] ログイン画面に戻る
- [ ] キャラクター作成ボタンが無効化される

---

### **Phase 6: キャラクター管理テスト**

#### 6.1 キャラクター管理アクセス（未ログイン時）
- [ ] 未ログイン状態でキャラクター管理ボタンをクリック
- [ ] 「ログインが必要です」のメッセージが表示

#### 6.2 キャラクター管理モーダル
- [ ] ログイン後にキャラクター管理ボタンをクリック
- [ ] キャラクター管理モーダルが表示される
- [ ] 「更新」「新規作成」ボタンが表示される

#### 6.3 キャラクター一覧表示
- [ ] キャラクター一覧が正常に表示される
- [ ] 各キャラクターに「プレビュー」「編集」「削除」ボタンが表示
- [ ] キャラクター情報（名前、説明、性格、専門分野）が表示

#### 6.4 キャラクター作成
- [ ] 「新規作成」ボタンをクリック
- [ ] キャラクター作成モーダルが表示
- [ ] 必要な項目（名前、性格、話し方、専門分野等）を入力
- [ ] 作成ボタンをクリック
- [ ] 作成成功メッセージが表示
- [ ] キャラクター一覧が更新される

#### 6.5 キャラクタープレビュー
- [ ] 「プレビュー」ボタンをクリック
- [ ] キャラクター詳細モーダルが表示
- [ ] 基本情報、システムプロンプト、追加設定が表示
- [ ] 「閉じる」「編集」ボタンが動作

#### 6.6 キャラクター編集
- [ ] 「編集」ボタンをクリック
- [ ] 編集モーダルが表示（既存データが入力済み）
- [ ] 項目を変更
- [ ] 「更新」ボタンをクリック
- [ ] 更新成功メッセージが表示
- [ ] キャラクター一覧が更新される

#### 6.7 キャラクター削除
- [ ] 「削除」ボタンをクリック
- [ ] 確認ダイアログが表示
- [ ] 「OK」をクリック
- [ ] 削除成功メッセージが表示
- [ ] キャラクター一覧から削除される

---

### **Phase 7: メモリ機能テスト**

#### 7.1 メモリ一覧表示
- [ ] メモリタブをクリック
- [ ] メモリ一覧が表示される
- [ ] 各メモリにタイトル、内容、作成日が表示

#### 7.2 メモリ作成
- [ ] チャットで数回メッセージをやり取り
- [ ] 「会話を記憶」ボタンをクリック
- [ ] 記憶タイトルを入力
- [ ] 保存ボタンをクリック
- [ ] 記憶成功メッセージが表示
- [ ] メモリ一覧が更新される

#### 7.3 メモリ更新
- [ ] 「更新」ボタンをクリック
- [ ] メモリ一覧が最新状態に更新される

---

### **Phase 8: トークン管理テスト**

#### 8.1 トークン使用量表示
- [ ] トークンタブをクリック
- [ ] 現在のトークン使用量が表示される
- [ ] チャット後に使用量が更新される

#### 8.2 トークンリセット
- [ ] 「トークンリセット」ボタンをクリック
- [ ] 確認ダイアログが表示
- [ ] 「OK」をクリック
- [ ] リセット成功メッセージが表示
- [ ] 使用量が0にリセットされる

---

### **Phase 9: セッション管理テスト**

#### 9.1 新規セッション
- [ ] 「新規セッション」ボタンをクリック
- [ ] 新しいセッションIDが生成される
- [ ] 会話履歴がクリアされる

#### 9.2 チャットクリア
- [ ] 「チャットクリア」ボタンをクリック
- [ ] 会話履歴がクリアされる
- [ ] セッションIDは変更されない

---

## 🐛 問題発生時の対処法

### よくある問題と解決方法

#### 1. サーバーが起動しない
```
問題: python api_server.py でエラーが発生
解決: 
- Python環境を確認
- 必要なライブラリがインストールされているか確認
- ポート8000が他のプロセスで使用されていないか確認
```

#### 2. ブラウザでページが表示されない
```
問題: http://localhost:3000 にアクセスできない
解決:
- Webサーバーが起動しているか確認
- ファイアウォール設定を確認
- 別のブラウザで試す
```

#### 3. API接続エラー
```
問題: 「サーバー未接続」と表示される
解決:
- APIサーバーが起動しているか確認
- ポート8000でサービスが動作しているか確認
- ネットワーク設定を確認
```

#### 4. エクスポート機能が動作しない
```
問題: ファイルがダウンロードされない
解決:
- ブラウザのポップアップブロック設定を確認
- ダウンロードフォルダの権限を確認
- 別のブラウザで試す
```

---

## 📊 テスト結果記録

### テスト実施日: _______________
### テスト実施者: _______________

#### 機能別テスト結果
| 機能 | テスト項目数 | 合格数 | 不合格数 | 合格率 | 備考 |
|------|-------------|--------|----------|--------|------|
| 基本動作 | 3 | ___ | ___ | ___% | |
| チャット機能 | 4 | ___ | ___ | ___% | |
| エクスポート機能 | 4 | ___ | ___ | ___% | |
| エラーハンドリング | 3 | ___ | ___ | ___% | |
| ユーザー管理 | 5 | ___ | ___ | ___% | |
| キャラクター管理 | 7 | ___ | ___ | ___% | |
| メモリ機能 | 3 | ___ | ___ | ___% | |
| トークン管理 | 2 | ___ | ___ | ___% | |
| セッション管理 | 2 | ___ | ___ | ___% | |

#### 総合評価
- **総テスト項目数**: 33項目
- **合格項目数**: ___項目
- **総合合格率**: ___%
- **判定**: □ 合格 □ 要修正

#### 発見された問題
1. ________________________________
2. ________________________________
3. ________________________________

#### 改善提案
1. ________________________________
2. ________________________________
3. ________________________________

---

## 📝 テスト完了チェックリスト

### サーバー起動
- [ ] APIサーバーが正常に起動
- [ ] Webサーバーが正常に起動
- [ ] ブラウザでページが表示される

### 基本機能
- [ ] 接続状態が正常に表示
- [ ] チャット機能が動作
- [ ] エクスポート機能が動作
- [ ] エラーハンドリングが動作

### ユーザー機能
- [ ] ユーザー登録が動作
- [ ] ログイン・ログアウトが動作
- [ ] プロフィール更新が動作

### キャラクター機能
- [ ] キャラクター作成が動作
- [ ] キャラクター管理が動作
- [ ] プレビュー・編集・削除が動作

### その他機能
- [ ] メモリ機能が動作
- [ ] トークン管理が動作
- [ ] セッション管理が動作

---

**テスト完了日**: _______________  
**テスト実施者**: _______________  
**承認者**: _______________
